<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Grist Statistics Widget</title>
    <!-- Grist Plugin API -->
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <!-- New Main Header -->
        <div class="main-header">
            <div class="header-filters">
                <div class="filter-group">
                    <label><span class="icon icon-calendar" style="width:20px;height:20px;margin-right:4px;"></span>
                        –ì–æ–¥:</label>
                    <select id="yearSelect" onchange="window.logic.applyCustomPeriod()">
                        <option value="all">–í–µ—Å—å –ø–µ—Ä–∏–æ–¥</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label><span class="icon icon-calendar" style="width:20px;height:20px;margin-right:4px;"></span>
                        –ú–µ—Å—è—Ü:</label>
                    <select id="monthSelect" onchange="window.logic.applyCustomPeriod()">
                        <option value="all">–í—Å–µ –º–µ—Å—è—Ü—ã</option>
                        <option value="1">–Ø–Ω–≤–∞—Ä—å</option>
                        <option value="2">–§–µ–≤—Ä–∞–ª—å</option>
                        <option value="3">–ú–∞—Ä—Ç</option>
                        <option value="4">–ê–ø—Ä–µ–ª—å</option>
                        <option value="5">–ú–∞–π</option>
                        <option value="6">–ò—é–Ω—å</option>
                        <option value="7">–ò—é–ª—å</option>
                        <option value="8">–ê–≤–≥—É—Å—Ç</option>
                        <option value="9">–°–µ–Ω—Ç—è–±—Ä—å</option>
                        <option value="10">–û–∫—Ç—è–±—Ä—å</option>
                        <option value="11">–ù–æ—è–±—Ä—å</option>
                        <option value="12">–î–µ–∫–∞–±—Ä—å</option>
                    </select>
                </div>
                <div class="period-selector" style="margin-top: 0; padding-top: 0; border-top: none;">
                    <label><span class="icon icon-calendar" style="width:20px;height:20px;margin-right:4px;"></span>
                        –î–∏–∞–ø–∞–∑–æ–Ω:</label>
                    <span id="dateRange"
                        style="font-size: 11px; color: var(--text-secondary); margin-left: 4px;">-</span>
                </div>
            </div>
            <div class="header-right">
                <span class="sheet-name" id="sheetName">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                <span class="greeting-text" id="greetingText"></span>
                <button class="nav-btn icon icon-home" id="homeBtn" onclick="window.logic.showHome()"
                    title="–ì–ª–∞–≤–Ω–∞—è"></button>
                <button class="nav-btn icon icon-calendar" id="calendarBtn" onclick="window.logic.showCalendar()"
                    title="–ö–∞–ª–µ–Ω–¥–∞—Ä—å"></button>
                <button class="settings-btn icon icon-settings" onclick="window.logic.openSettings()"
                    title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏"></button>
            </div>
        </div>

        <!-- Hidden info for compatibility -->
        <div style="display:none;">
            <span id="totalRows">-</span>
            <span id="filteredRows">-</span>
            <span id="totalColumns">-</span>
            <span id="periodLabel">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</span>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</p>
        </div>

        <div id="content" style="display: none;">
            <!-- Two Column Layout -->
            <div class="main-content">
                <!-- Left Column - Tables -->
                <div class="left-column">
                    <!-- Weekly Statistics -->
                    <div id="weeklyStatsSection" class="data-block" style="display: none;">
                        <h3><span class="icon icon-calendar"></span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –Ω–µ–¥–µ–ª—è–º</h3>
                        <table class="weekly-table">
                            <thead>
                                <tr>
                                    <th>–ù–µ–¥–µ–ª—è</th>
                                    <th>–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</th>
                                    <th>–ù–æ—Ä–º–∞</th>
                                    <th>–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞</th>
                                    <th>–ü—Ä–æ—Å—Ç–æ–π</th>
                                    <th>–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ</th>
                                    <th>–†–∞–∑–º–µ—á–µ–Ω–æ</th>
                                    <th>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å</th>
                                </tr>
                            </thead>
                            <tbody id="weeklyTableBody"></tbody>
                        </table>
                    </div>

                    <!-- –ü—Ä–æ–µ–∫—Ç -->
                    <div id="projectSection" class="projects-section" style="display: none;">
                        <h2>
                            <span class="icon icon-doc"></span>
                            <span>–ü—Ä–æ–µ–∫—Ç</span>
                        </h2>
                        <table class="projects-table">
                            <thead>
                                <tr>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'name')" style="cursor: pointer;">
                                        –ù–∞–∑–≤–∞–Ω–∏–µ <span id="sort-–ü—Ä–æ–µ–∫—Ç-name">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'pureHours')"
                                        style="cursor: pointer;">
                                        –ß–∞—Å—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ <span id="sort-–ü—Ä–æ–µ–∫—Ç-pureHours">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'tasks')" style="cursor: pointer;">
                                        –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ <span id="sort-–ü—Ä–æ–µ–∫—Ç-tasks">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'avgMainTasks')"
                                        style="cursor: pointer;">
                                        –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ <span id="sort-–ü—Ä–æ–µ–∫—Ç-avgMainTasks">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'markupHours')"
                                        style="cursor: pointer;">
                                        –ß–∞—Å—ã —Ä–∞–∑–º–µ—Ç–∫–∏ <span id="sort-–ü—Ä–æ–µ–∫—Ç-markupHours">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'markupTasks')"
                                        style="cursor: pointer;">
                                        –†–∞–∑–º–µ—á–µ–Ω–æ <span id="sort-–ü—Ä–æ–µ–∫—Ç-markupTasks">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'avgMarkupTasks')"
                                        style="cursor: pointer;">
                                        –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞–∑–º–µ—Ç–∫–∏ <span id="sort-–ü—Ä–æ–µ–∫—Ç-avgMarkupTasks">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'additionalHours')"
                                        style="cursor: pointer;">
                                        –ò–Ω—ã–µ —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã <span id="sort-–ü—Ä–æ–µ–∫—Ç-additionalHours">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü—Ä–æ–µ–∫—Ç', 'totalHours')"
                                        style="cursor: pointer;">
                                        –í—Å–µ–≥–æ —á–∞—Å–æ–≤ <span id="sort-–ü—Ä–æ–µ–∫—Ç-totalHours">‚ÜïÔ∏è</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="projectTableBody"></tbody>
                        </table>
                    </div>

                    <!-- –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ -->
                    <div id="overtimeSection" class="projects-section" style="display: none;">
                        <h2>
                            <span class="icon icon-fire"></span>
                            <span>–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞</span>
                        </h2>
                        <table class="projects-table">
                            <thead>
                                <tr>
                                    <th onclick="window.logic.sortWorkType('–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞', 'name')"
                                        style="cursor: pointer;">
                                        –ù–∞–∑–≤–∞–Ω–∏–µ <span id="sort-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞-name">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞', 'tasks')"
                                        style="cursor: pointer;">
                                        –í—Å–µ–≥–æ –∑–∞–¥–∞—á <span id="sort-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞-tasks">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞', 'hours')"
                                        style="cursor: pointer;">
                                        –ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã <span id="sort-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞-hours">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞', 'entries')"
                                        style="cursor: pointer;">
                                        –ó–∞–ø–∏—Å–µ–π <span id="sort-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞-entries">‚ÜïÔ∏è</span>
                                    </th>
                                    <th onclick="window.logic.sortWorkType('–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞', 'avgHours')"
                                        style="cursor: pointer;">
                                        –°—Ä. —á–∞—Å–æ–≤/–∑–∞–¥–∞—á–∞ <span id="sort-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞-avgHours">‚ÜïÔ∏è</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="overtimeTableBody"></tbody>
                        </table>
                    </div>
                </div><!-- End Left Column -->

                <!-- Right Column - Sidebar -->
                <div class="right-column">
                    <!-- Workload Summary -->
                    <div class="workload-sidebar">
                        <h3><span class="icon icon-stats"></span> –ù–∞–≥—Ä—É–∑–∫–∞ –æ–±—â–∞—è</h3>
                        <div class="circular-progress-container">
                            <div class="liquid-circle">
                                <svg class="liquid-svg" viewBox="0 0 200 200">
                                    <defs>
                                        <clipPath id="circleClip">
                                            <circle cx="100" cy="100" r="90" />
                                        </clipPath>
                                        <linearGradient id="liquidGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                            <stop offset="0%" style="stop-color:#E3FB1E" />
                                            <stop offset="100%" style="stop-color:#9ab012" />
                                        </linearGradient>
                                    </defs>
                                    <g clip-path="url(#circleClip)">
                                        <g id="liquidGroup" transform="translate(0,190)">
                                            <!-- –í–æ–ª–Ω–∞ 1 (–æ—Å–Ω–æ–≤–Ω–∞—è) - —É–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ -->
                                            <path id="wave1" class="wave-path"
                                                d="M-40,15 Q-10,-8 20,15 Q50,38 80,15 Q110,-8 140,15 Q170,38 200,15 Q230,-8 260,15 L260,200 L-40,200 Z"
                                                fill="#c4d916" />
                                            <!-- –í–æ–ª–Ω–∞ 2 (—Å–≤–µ—Ç–ª–∞—è —Å–≤–µ—Ä—Ö—É) -->
                                            <path id="wave2" class="wave-path wave-path-2"
                                                d="M-40,10 Q0,-12 40,10 Q80,32 120,10 Q160,-12 200,10 Q240,32 280,10 L280,200 L-40,200 Z"
                                                fill="rgba(227,251,30,0.6)" />
                                        </g>
                                        <!-- –ë—Ä—ã–∑–≥–∏ (–æ—Ç–¥–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞) -->
                                        <g id="splashGroup">
                                            <circle class="splash splash-1" cx="30" cy="5" r="4"
                                                fill="rgba(227,251,30,0.7)" />
                                            <circle class="splash splash-2" cx="90" cy="8" r="3"
                                                fill="rgba(196,217,22,0.8)" />
                                            <circle class="splash splash-3" cx="150" cy="3" r="3.5"
                                                fill="rgba(227,251,30,0.6)" />
                                            <circle class="splash splash-4" cx="60" cy="6" r="2"
                                                fill="rgba(180,200,20,0.7)" />
                                            <circle class="splash splash-5" cx="120" cy="4" r="2.5"
                                                fill="rgba(227,251,30,0.8)" />
                                        </g>
                                    </g>
                                </svg>
                                <div class="percentage-overlay">
                                    <span class="big-percentage" id="workloadPercentage">0%</span>
                                </div>
                            </div>
                        </div>
                        <div class="hours-text" id="workloadText">0 —á –∏–∑ 0 —á</div>
                    </div>

                    <!-- Today Stats -->
                    <div class="today-sidebar">
                        <div class="today-header">
                            <h3><span class="icon icon-calendar"></span> –°–µ–≥–æ–¥–Ω—è</h3>
                            <button class="return-today-btn" id="returnTodayBtn" onclick="window.logic.returnToToday()"
                                style="display: none;">
                                <span class="icon icon-arrow">‚Üê</span> –í–µ—Ä–Ω—É—Ç—å—Å—è
                            </button>
                        </div>
                        <div class="today-date-picker">
                            <input type="date" id="todayDateFrom" class="date-input"
                                onchange="window.logic.loadTodayRange()">
                            <span class="date-separator">‚Äî</span>
                            <input type="date" id="todayDateTo" class="date-input"
                                onchange="window.logic.loadTodayRange()">
                        </div>
                        <div class="today-grid">
                            <div class="today-tile">
                                <span class="tile-icon icon icon-time"></span>
                                <span class="tile-value" id="todayTotalHours">-</span>
                                <span class="tile-label">–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</span>
                            </div>
                            <div class="today-tile">
                                <span class="tile-icon icon icon-fire"></span>
                                <span class="tile-value" id="todayOvertimeHours">-</span>
                                <span class="tile-label">–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞</span>
                            </div>
                            <div class="today-tile">
                                <span class="tile-icon icon icon-pause"></span>
                                <span class="tile-value" id="todayIdleHours">-</span>
                                <span class="tile-label">–ü—Ä–æ—Å—Ç–æ–π</span>
                            </div>
                            <div class="today-tile">
                                <span class="tile-icon icon icon-check"></span>
                                <span class="tile-value" id="todayCheckHours">-</span>
                                <span class="tile-label">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ</span>
                            </div>
                            <div class="today-tile">
                                <span class="tile-icon icon icon-tag"></span>
                                <span class="tile-value" id="todayMarkupHours">-</span>
                                <span class="tile-label">–†–∞–∑–º–µ—á–µ–Ω–æ</span>
                            </div>
                            <div class="today-tile">
                                <span class="tile-icon icon icon-doc"></span>
                                <span class="tile-value" id="todayOtherHours">-</span>
                                <span class="tile-label">–ò–Ω—ã–µ –∑–∞–¥–∞—á–∏</span>
                            </div>
                            <div class="today-tile">
                                <span class="tile-icon icon icon-list"></span>
                                <span class="tile-value" id="todayCheckedTasksCount">-</span>
                                <span class="tile-label">–ó–∞–¥–∞—á –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ</span>
                            </div>
                            <div class="today-tile">
                                <span class="tile-icon icon icon-bookmark"></span>
                                <span class="tile-value" id="todayMarkedTasksCount">-</span>
                                <span class="tile-label">–ó–∞–¥–∞—á —Ä–∞–∑–º–µ—á–µ–Ω–æ</span>
                            </div>
                        </div>
                    </div>
                </div><!-- End Right Column -->
            </div><!-- End main-content -->
        </div><!-- End content -->

        <!-- Calendar View -->
        <div id="calendarView" class="calendar-view" style="display: none;">
            <div class="calendar-controls">
                <button class="calendar-nav-btn" onclick="window.logic.prevMonth()">‚óÄ</button>
                <div class="calendar-title-selects">
                    <select id="calendarMonthSelect" class="calendar-select"
                        onchange="window.logic.updateCalendarView()">
                        <option value="0">–Ø–Ω–≤–∞—Ä—å</option>
                        <option value="1">–§–µ–≤—Ä–∞–ª—å</option>
                        <option value="2">–ú–∞—Ä—Ç</option>
                        <option value="3">–ê–ø—Ä–µ–ª—å</option>
                        <option value="4">–ú–∞–π</option>
                        <option value="5">–ò—é–Ω—å</option>
                        <option value="6">–ò—é–ª—å</option>
                        <option value="7">–ê–≤–≥—É—Å—Ç</option>
                        <option value="8">–°–µ–Ω—Ç—è–±—Ä—å</option>
                        <option value="9">–û–∫—Ç—è–±—Ä—å</option>
                        <option value="10">–ù–æ—è–±—Ä—å</option>
                        <option value="11">–î–µ–∫–∞–±—Ä—å</option>
                    </select>
                    <select id="calendarYearSelect" class="calendar-select"
                        onchange="window.logic.updateCalendarView()">
                        <!-- Years will be populated dynamically -->
                    </select>
                </div>
                <button class="calendar-nav-btn" onclick="window.logic.nextMonth()">‚ñ∂</button>
            </div>

            <div class="calendar-grid" id="calendarGrid">
                <!-- Headers -->
                <div class="calendar-header-cell week-number-header">–ù–µ–¥</div>
                <div class="calendar-header-cell">–ü–Ω</div>
                <div class="calendar-header-cell">–í—Ç</div>
                <div class="calendar-header-cell">–°—Ä</div>
                <div class="calendar-header-cell">–ß—Ç</div>
                <div class="calendar-header-cell">–ü—Ç</div>
                <div class="calendar-header-cell" style="color: #e57373;">–°–±</div>
                <div class="calendar-header-cell" style="color: #e57373;">–í—Å</div>
                <!-- Days will be populated via JS -->
            </div>

            <div class="calendar-legend">
                <div class="legend-item">
                    <div class="legend-dot today"></div>
                    <span>–°–µ–≥–æ–¥–Ω—è</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot holiday"></div>
                    <span>–ü—Ä–∞–∑–¥–Ω–∏–∫</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot short"></div>
                    <span>–°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–π</span>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal-overlay">
            <div class="modal" style="max-width: 600px;">
                <div class="modal-header">
                    <h2><span class="icon icon-settings"></span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                    <button class="modal-close" onclick="window.logic.closeSettings()">√ó</button>
                </div>

                <!-- Tabs -->
                <div class="settings-tabs">
                    <button class="settings-tab active" id="tabBtnUser"
                        onclick="window.logic.switchSettingsTab('user')">üë§
                        –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</button>
                    <button class="settings-tab" id="tabBtnCalendar"
                        onclick="window.logic.switchSettingsTab('calendar')"><span class="icon icon-calendar"
                            style="width:18px;height:18px;margin-right:4px;"></span>
                        –ö–∞–ª–µ–Ω–¥–∞—Ä—å</button>
                </div>

                <div class="modal-body">
                    <!-- User Tab -->
                    <div id="userTab" class="settings-tab-content active">
                        <div class="settings-group">
                            <label>üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                            <div class="add-date-row">
                                <input type="text" id="userName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è"
                                    style="flex: 1; font-size: 15px;" oninput="window.logic.saveUserName()">
                            </div>
                            <p style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">
                                –ò–º—è –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                            </p>
                        </div>
                    </div>

                    <!-- Calendar Tab -->
                    <div id="calendarTab" class="settings-tab-content">
                        <div class="settings-group">
                            <label for="calendarYear"><span class="icon icon-calendar"
                                    style="width:18px;height:18px;margin-right:4px;"></span> –ì–æ–¥:</label>
                            <div class="year-selector-row">
                                <select id="calendarYear" onchange="renderSettingsUI()">
                                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                                </select>
                                <button class="btn-add-year" onclick="window.logic.addNewYear()">+ –ì–æ–¥</button>
                                <button class="btn-add-year" onclick="window.logic.deleteYear()"
                                    style="background-color: #ff5252; margin-left: 5px;">- –£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                        </div>

                        <div class="settings-group">
                            <label><span class="icon icon-party"
                                    style="width:18px;height:18px;margin-right:4px;"></span> –ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –¥–Ω–∏
                                (–≤—ã—Ö–æ–¥–Ω—ã–µ):</label>
                            <div class="dates-container" id="holidaysList"></div>
                            <div class="add-date-row">
                                <input type="text" id="newHoliday" placeholder="–î–î.–ú–ú" maxlength="5">
                                <button class="btn-add" onclick="window.logic.addHoliday()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>

                        <div class="settings-group">
                            <label><span class="icon icon-clock"
                                    style="width:18px;height:18px;margin-right:4px;"></span> –°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ –¥–Ω–∏ (7
                                —á–∞—Å–æ–≤):</label>
                            <div class="dates-container" id="shortDaysList"></div>
                            <div class="add-date-row">
                                <input type="text" id="newShortDay" placeholder="–î–î.–ú–ú" maxlength="5">
                                <button class="btn-add" onclick="window.logic.addShortDay()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>

                        <div class="settings-group"
                            style="border-top: 1px solid #e0e0e0; padding-top: 15px; margin-top: 15px;">
                            <label>üì¶ –ò–º–ø–æ—Ä—Ç / –≠–∫—Å–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫:</label>
                            <div class="add-date-row" style="gap: 10px;">
                                <button class="btn-add" onclick="window.logic.exportSettings()" style="flex: 1;">‚¨á
                                    –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                                <button class="btn-add" onclick="window.logic.importSettings()" style="flex: 1;">‚¨Ü
                                    –ò–º–ø–æ—Ä—Ç JSON</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Project Detail Modal -->
        <div id="projectModal" class="modal-overlay">
            <div class="modal" style="max-width: 1200px;">
                <div class="modal-header">
                    <h2><span class="icon icon-stats"></span> <span id="projectModalTitle">–ü—Ä–æ–µ–∫—Ç</span></h2>
                    <button class="modal-close" onclick="window.logic.closeProjectModal()">√ó</button>
                </div>

                <div class="modal-body">
                    <div id="projectLoading"
                        style="display: none; align-items: center; justify-content: center; flex-direction: column; min-height: 400px; width: 100%;">
                        <div class="spinner"></div>
                        <p style="margin-top: 10px; color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
                    </div>
                    <div id="projectContent">
                        <div class="project-controls"
                            style="display: flex; justify-content: space-between; align-items: flex-start; gap: 20px; margin-bottom: 20px;">
                            <div class="project-filters" style="margin-bottom: 0;">
                                <div class="filter-group">
                                    <label>–ì–æ–¥:</label>
                                    <select id="projectYearSelect" onchange="window.logic.loadProjectStats()">
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>–ú–µ—Å—è—Ü:</label>
                                    <select id="projectMonthSelect" onchange="window.logic.loadProjectStats()">
                                        <option value="0">–í—Å–µ –º–µ—Å—è—Ü—ã</option>
                                        <option value="1">–Ø–Ω–≤–∞—Ä—å</option>
                                        <option value="2">–§–µ–≤—Ä–∞–ª—å</option>
                                        <option value="3">–ú–∞—Ä—Ç</option>
                                        <option value="4">–ê–ø—Ä–µ–ª—å</option>
                                        <option value="5">–ú–∞–π</option>
                                        <option value="6">–ò—é–Ω—å</option>
                                        <option value="7">–ò—é–ª—å</option>
                                        <option value="8">–ê–≤–≥—É—Å—Ç</option>
                                        <option value="9">–°–µ–Ω—Ç—è–±—Ä—å</option>
                                        <option value="10">–û–∫—Ç—è–±—Ä—å</option>
                                        <option value="11">–ù–æ—è–±—Ä—å</option>
                                        <option value="12">–î–µ–∫–∞–±—Ä—å</option>
                                    </select>
                                </div>
                            </div>

                            <div class="project-summary" style="margin-bottom: 0; flex: 1;">
                                <div class="summary-card">
                                    <div class="summary-value" id="projectTotalHours">0</div>
                                    <div class="summary-label">–í—Å–µ–≥–æ —á–∞—Å–æ–≤</div>
                                </div>
                                <div class="summary-card">
                                    <div class="summary-value" id="projectTotalTasks">0</div>
                                    <div class="summary-label">–ó–∞–¥–∞—á</div>
                                </div>
                                <div class="summary-card">
                                    <div class="summary-value" id="projectAvgHours">0</div>
                                    <div class="summary-label">–°—Ä–µ–¥. —á–∞—Å–æ–≤/–Ω–µ–¥</div>
                                </div>
                            </div>
                        </div>

                        <div class="project-weekly-table">
                            <table class="projects-table">
                                <thead>
                                    <tr>
                                        <th>–ù–µ–¥–µ–ª—è</th>
                                        <th>–î–∞—Ç—ã</th>
                                        <th>–ß–∞—Å—ã –ø—Ä–æ–≤–µ—Ä–∫–∏</th>
                                        <th>–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ</th>
                                        <th>–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏</th>
                                        <th>–ß–∞—Å—ã —Ä–∞–∑–º–µ—Ç–∫–∏</th>
                                        <th>–†–∞–∑–º–µ—á–µ–Ω–æ</th>
                                        <th>–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞–∑–º–µ—Ç–∫–∏</th>
                                        <th>–ò–Ω—ã–µ —á–∞—Å—ã</th>
                                        <th>–í—Å–µ–≥–æ —á–∞—Å–æ–≤</th>
                                    </tr>
                                </thead>
                                <tbody id="projectWeeklyBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn-cancel" onclick="window.logic.closeProjectModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- Day Statistics Modal -->
        <div id="dayModal" class="modal-overlay">
            <div class="modal" style="max-width: 1400px;">
                <div class="modal-header">
                    <h2><span class="icon icon-calendar"></span> <span id="dayModalTitle">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –¥–µ–Ω—å</span></h2>
                    <button class="modal-close" onclick="window.logic.closeDayModal()">√ó</button>
                </div>

                <div class="modal-body">
                    <!-- Day Summary -->
                    <div class="summary-card">
                        <div class="summary-value" id="dayWorkHours">0</div>
                        <div class="summary-label">–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value" id="dayProjects">0</div>
                        <div class="summary-label">–ü—Ä–æ–µ–∫—Ç–æ–≤</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value" id="dayCheckedTasks">0</div>
                        <div class="summary-label">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ</div>
                    </div>
                </div>

                <!-- Projects Table -->
                <div class="project-weekly-table">
                    <table class="projects-table">
                        <thead>
                            <tr>
                                <th>–ü—Ä–æ–µ–∫—Ç</th>
                                <th>–ß–∞—Å—ã –ø—Ä–æ–≤–µ—Ä–∫–∏</th>
                                <th>–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ</th>
                                <th>–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏</th>
                                <th>–ß–∞—Å—ã —Ä–∞–∑–º–µ—Ç–∫–∏</th>
                                <th>–†–∞–∑–º–µ—á–µ–Ω–æ</th>
                                <th>–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞–∑–º–µ—Ç–∫–∏</th>
                                <th>–ò–Ω—ã–µ —á–∞—Å—ã</th>
                                <th>–í—Å–µ–≥–æ —á–∞—Å–æ–≤</th>
                            </tr>
                        </thead>
                        <tbody id="dayProjectsBody">
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="window.logic.closeDayModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>
        <script src="script.js"></script>
</body>

</html>